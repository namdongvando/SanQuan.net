app.controller("addproductController", addproductController);function addproductController($scope, $rootScope, $http, $routeParams, $UserInfor) {    $scope._Product = {        "Price": 0        , "catIDCL": "1"        , "catID": "3"        , "Tinh": "32"        , "Huyen": "33"    };    $http.get("/api/getCategorysByParentID/0").then(function (res) {        $scope._DSChungLoai = res.data;        $scope.ChungLoaiSanPhamThayDoi($scope._Product.catIDCL);    });    $scope.ChungLoaiSanPhamThayDoi = function (id) {        $http.get("/api/getCategorysByParentID/" + id).then(function (res) {            $scope._DSLoaiSP = res.data;            $scope._Product.catID = $scope._DSLoaiSP[0].catID;        });    }    $http.get("/api/getUnitByUnitTypes/PriceUnit/").then(function (res) {        $scope._Unit = res.data;    });    $http.get("/api/getAllCategorys/").then(function (res) {        $scope._ListCategory = res.data;    });    $http.get("/api/DSTinh/0").then(function (res) {        $scope._DSTinh = res.data;        $scope.DSHuyenTheoTinh($scope._Product.Tinh);    });    $scope.DSHuyenTheoTinh = function (Tinh) {        $http.get("/api/DSHuyen/" + Tinh).then(function (res) {            $scope._DSHuyen = res.data;            $scope._Product.Huyen = res.data[0].id;        });    }    $scope.Note = {"PriceUnit": "5"};    $scope.LoadProductDetail = function (id) {        $http.get("/api/getProductByID/" + id).then(function (res) {            $scope._Product = res.data;            $scope.ChungLoaiSanPhamThayDoi($scope._Product.catIDCL);        });        $UserInfor.ImgSanPhamById(id).then(function (res) {            $scope.imagesTemp = res.data        });    }    $scope.clearImgByNameEdit = function (pid, img) {//        console.log(pid);//        console.log(img);        $UserInfor.clearImgtempProduct(pid, img).then(function (res) {            $scope.imagesTemp = res.data;        });    }    $scope.clearImgByName = function (img) {        $UserInfor.clearImgtemp(img).then(function (res) {            $scope.imagesTemp = res.data;        });    }    $scope.uploadSelectFile = function () {        uploadFile("/user/api/uploadfile", null);    }    $scope.uploadFileToProduct = function (id) {        uploadFile("/user/api/uploadfileProduct/" + id, id);    }//    uploadfileProduct    function _(el) {        return document.getElementById(el);    }    $scope.DriverByUser = function () {        $http.get("/user/api/DriverByUser/").then(function (res) {            $scope.imagesTemp = res.data;        });    }    function uploadFile(url, idp) {        var file = _("file1").files;        if (file.length <= 6) {            for (var i = 0; i < file.length; i++) {                var formdata = new FormData();                formdata.append("file1", file[i]);                var ajax = new XMLHttpRequest();                // không cho bất đồng bộ                ajax.open("POST", url, false);                ajax.send(formdata);                ajax.onreadystatechange = function (e) {                    if (this.readyState == 4 && this.status == 200) {                    }                }            }            $scope.renderImages(idp);        } else {            window.alert("bạn chọn quá nhiều file");        }    }    $scope.renderImages = function (idp) {        if (!idp) {            $http.get("/user/api/DriverByUser/").then(function (res) {                $scope.imagesTemp = res.data;            });            return;        }        $http.get("/user/api/imgbyproduct/" + idp).then(function (res) {            $scope.imagesTemp = res.data;        });    }}